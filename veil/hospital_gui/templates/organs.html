<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Veil Security Organs</title>
    <link rel="stylesheet" href="/static/style.css">
    <style>
        .organ-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 16px; margin-top: 16px; }
        .organ-card { background: #111827; border-radius: 12px; padding: 16px; border-left: 4px solid #10b981; }
        .organ-card.p0 { border-left-color: #ef4444; }
        .organ-card.p1 { border-left-color: #f59e0b; }
        .organ-header { display: flex; justify-content: space-between; align-items: center; }
        .organ-name { font-weight: 600; font-size: 1.1em; margin: 8px 0; }
        .organ-glyph { font-size: 1.5em; }
        .organ-tier { font-size: 0.7em; padding: 2px 8px; border-radius: 4px; background: #1f2937; }
        .organ-status { display: flex; align-items: center; gap: 8px; color: #10b981; }
        .status-dot { width: 10px; height: 10px; border-radius: 50%; background: #10b981; box-shadow: 0 0 8px #10b981; }
        .tier-section { margin-bottom: 32px; }
        .tier-title { font-size: 1.2em; margin-bottom: 8px; padding-bottom: 8px; border-bottom: 1px solid #1f2937; }
        .tier-title.p0 { color: #ef4444; }
        .tier-title.p1 { color: #f59e0b; }
        .tier-title.p2 { color: #3b82f6; }
        .stats { display: flex; gap: 20px; margin-bottom: 24px; }
        .stat { background: #111827; padding: 16px 24px; border-radius: 12px; }
        .stat-num { font-size: 2em; font-weight: bold; color: #10b981; }
        .stat-label { color: #9ca3af; }
        .btn-restart { background: #7c2d12; color: #fff; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 1em; }
        .btn-restart:hover { background: #991b1b; }
        .header-actions { display: flex; gap: 12px; }
    </style>
</head>
<body>
    <nav class="sidebar">
        <div class="logo">üè• Veil Hospital</div>
        <a href="/" class="nav-btn">üñ•Ô∏è Systems</a>
        <a href="/patients" class="nav-btn">üë§ Patients</a>
        <a href="/discharged" class="nav-btn">üö™ Discharged</a>
        <a href="/organs" class="nav-btn active">üõ°Ô∏è Security</a>
        <a href="/status" class="nav-btn">üìä Status</a>
    </nav>
    <main>
        <header>
            <h1>ü´Ä Security Organs</h1>
            <div class="header-actions">
                <button class="btn-restart" onclick="restartVeil()">üîÑ Restart Veil</button>
            </div>
        </header>
        <div class="stats">
            <div class="stat"><div class="stat-num">{{ total }}</div><div class="stat-label">Total</div></div>
            <div class="stat"><div class="stat-num">{{ total }}</div><div class="stat-label">Running</div></div>
            <div class="stat"><div class="stat-num">{{ p0|length }}</div><div class="stat-label">Critical</div></div>
            <div class="stat"><div class="stat-num">{{ p1|length }}</div><div class="stat-label">Important</div></div>
        </div>
        {% if p0 %}
        <div class="tier-section">
            <h2 class="tier-title p0">‚ö†Ô∏è Critical (P0)</h2>
            <div class="organ-grid">
                {% for o in p0 %}
                <div class="organ-card p0">
                    <div class="organ-header"><span class="organ-glyph">{{ o.glyph }}</span><span class="organ-tier">P0</span></div>
                    <div class="organ-name">{{ o.name }}</div>
                    <div class="organ-status"><span class="status-dot"></span><span>Running</span></div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        {% if p1 %}
        <div class="tier-section">
            <h2 class="tier-title p1">üî∂ Important (P1)</h2>
            <div class="organ-grid">
                {% for o in p1 %}
                <div class="organ-card p1">
                    <div class="organ-header"><span class="organ-glyph">{{ o.glyph }}</span><span class="organ-tier">P1</span></div>
                    <div class="organ-name">{{ o.name }}</div>
                    <div class="organ-status"><span class="status-dot"></span><span>Running</span></div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        {% if p2 %}
        <div class="tier-section">
            <h2 class="tier-title p2">üî∑ Standard (P2)</h2>
            <div class="organ-grid">
                {% for o in p2 %}
                <div class="organ-card">
                    <div class="organ-header"><span class="organ-glyph">{{ o.glyph }}</span><span class="organ-tier">P2</span></div>
                    <div class="organ-name">{{ o.name }}</div>
                    <div class="organ-status"><span class="status-dot"></span><span>Running</span></div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </main>
    <script>
        async function restartVeil() {
            if (!confirm('Restart all Veil OS organs?')) return;
            await fetch('/api/restart', { method: 'POST' });
            location.reload();
        }
    </script>
</body>
</html>
